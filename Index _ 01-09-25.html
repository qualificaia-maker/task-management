<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Gestione Task - ERP</title>
    
    <!-- React e React DOM -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Animazioni personalizzate */
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .animate-slideUp { animation: slideUp 0.3s ease-out; }
        .animate-slideDown { animation: slideDown 0.2s ease-out; }
        .animate-fadeIn { animation: fadeIn 0.2s ease-out; }
        .dragging { opacity: 0.5; cursor: grabbing !important; }
        .drag-over { border-top: 3px solid #3b82f6; }
        .grip-handle:hover { color: #6b7280; transform: scale(1.1); }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <!-- Carica i componenti JavaScript -->
    <script src="components/1-componenti-condivisi.js"></script>
    <script src="components/2-aggiungi-task.js"></script>
    <script src="components/3-tabella-task.js"></script>
    <script src="components/4-filtri-avanzati.js"></script>
    <script src="components/5-main-app.js"></script>
    
    <!-- Script principale -->
    <script>
        // Inizializza le icone Lucide (versione semplificata)
        window.LucideIcons = {};
        const iconNames = ['Search', 'Filter', 'Calendar', 'Users', 'CheckCircle', 'Clock', 
                          'AlertCircle', 'ChevronDown', 'ChevronRight', 'ChevronUp', 'X', 'Plus', 
                          'Download', 'RefreshCw', 'Eye', 'Trash2', 'Edit', 'Edit2', 'MoreVertical', 
                          'Star', 'Save', 'FolderOpen', 'Paperclip', 'UserPlus', 'Building', 'Phone', 
                          'MessageSquare', 'Lock', 'Repeat', 'FileText', 'Columns', 'ArrowUpDown', 
                          'Loader', 'Check', 'Info', 'GripVertical', 'User'];
        
        iconNames.forEach(name => {
            window.LucideIcons[name] = (props) => React.createElement('span', 
                { ...props, style: { display: 'inline-block', width: '1em', height: '1em' } }, 
                ''
            );
        });
        
        // Aspetta che React e ReactDOM siano caricati
        setTimeout(() => {
            // Verifica che React e ReactDOM esistano
            if (typeof React === 'undefined' || typeof ReactDOM === 'undefined') {
                console.error('React o ReactDOM non caricati!');
                document.getElementById('root').innerHTML = `
                    <div style="padding: 20px; background: #fee; border: 2px solid #f00; margin: 20px; border-radius: 8px;">
                        <h2>Errore di caricamento</h2>
                        <p>React o ReactDOM non si sono caricati correttamente.</p>
                        <p>Prova a:</p>
                        <ol>
                            <li>Ricaricare la pagina (F5)</li>
                            <li>Controllare la connessione internet</li>
                            <li>Aprire in un browser diverso</li>
                        </ol>
                    </div>
                `;
                return;
            }
            
            console.log('React e ReactDOM caricati correttamente');
            console.log('Controllo componenti...');
            
            // Controlla se i componenti esterni sono stati caricati
            const componentsLoaded = {
                SharedComponents: typeof window.SharedComponents !== 'undefined',
                QuickAddTask: typeof window.QuickAddTask !== 'undefined',
                TaskTable: typeof window.TaskTable !== 'undefined',
                AdvancedFilters: typeof window.AdvancedFilters !== 'undefined',
                TaskManagement: typeof window.TaskManagement !== 'undefined'
            };
            
            console.log('Stato componenti:', componentsLoaded);
            
            // Se TUTTI i componenti sono caricati, usa l'app completa
            if (Object.values(componentsLoaded).every(loaded => loaded)) {
                console.log('Tutti i componenti caricati! Avvio app completa...');
                
                const root = ReactDOM.createRoot(document.getElementById('root'));
                root.render(React.createElement(window.TaskManagement));
                
            } else {
                console.log('Componenti mancanti, avvio app di test...');
                console.log('Assicurati che i file .js siano nella cartella "components"');
                
                // App di test semplificata
                const TestApp = () => {
                    const [tasks, setTasks] = React.useState([
                        { id: 1, title: 'Task di esempio 1', status: 'pending', priority: 'high' },
                        { id: 2, title: 'Task di esempio 2', status: 'completed', priority: 'normal' }
                    ]);
                    
                    return React.createElement('div', { className: "min-h-screen bg-gray-50 p-8" },
                        React.createElement('div', { className: "max-w-6xl mx-auto" },
                            // Header con avviso
                            React.createElement('div', { className: "bg-red-50 border border-red-200 rounded-lg p-4 mb-6" },
                                React.createElement('h2', { className: "text-red-800 font-bold mb-2" }, 
                                    "App in modalità TEST - File mancanti"
                                ),
                                React.createElement('p', { className: "text-red-700 text-sm mb-2" },
                                    "I file JavaScript non sono stati trovati. Assicurati di:"
                                ),
                                React.createElement('ol', { className: "list-decimal list-inside text-red-700 text-sm space-y-1" },
                                    React.createElement('li', null, 'Creare una cartella chiamata "components"'),
                                    React.createElement('li', null, 'Salvare i 5 file come .js (NON .txt o .docx)'),
                                    React.createElement('li', null, 'Mettere i file nella cartella components'),
                                    React.createElement('li', null, 'Ricaricare questa pagina')
                                ),
                                React.createElement('div', { className: "mt-3 p-2 bg-white rounded" },
                                    React.createElement('p', { className: "text-xs text-gray-600" }, "File mancanti:"),
                                    React.createElement('ul', { className: "text-xs text-red-600 mt-1" },
                                        !componentsLoaded.SharedComponents && React.createElement('li', null, '- 1-componenti-condivisi.js'),
                                        !componentsLoaded.QuickAddTask && React.createElement('li', null, '- 2-aggiungi-task.js'),
                                        !componentsLoaded.TaskTable && React.createElement('li', null, '- 3-tabella-task.js'),
                                        !componentsLoaded.AdvancedFilters && React.createElement('li', null, '- 4-filtri-avanzati.js'),
                                        !componentsLoaded.TaskManagement && React.createElement('li', null, '- 5-main-app.js')
                                    )
                                )
                            ),
                            
                            // App di test base
                            React.createElement('h1', { className: "text-3xl font-bold mb-6" }, 
                                "Sistema Gestione Task - Modalità Test"
                            ),
                            
                            React.createElement('div', { className: "bg-white rounded-lg shadow p-6 mb-6" },
                                React.createElement('h2', { className: "text-xl font-semibold mb-4" }, 
                                    "Quick Add Task (Test)"
                                ),
                                React.createElement('input', {
                                    type: "text",
                                    placeholder: "Inserisci nome task e premi Enter...",
                                    className: "w-full px-4 py-2 border rounded-lg",
                                    onKeyPress: (e) => {
                                        if (e.key === 'Enter' && e.target.value) {
                                            const newTask = {
                                                id: Date.now(),
                                                title: e.target.value,
                                                status: 'pending',
                                                priority: 'normal'
                                            };
                                            setTasks([...tasks, newTask]);
                                            e.target.value = '';
                                        }
                                    }
                                })
                            ),
                            
                            React.createElement('div', { className: "bg-white rounded-lg shadow p-6" },
                                React.createElement('h2', { className: "text-xl font-semibold mb-4" }, 
                                    `Lista Task (${tasks.length} totali)`
                                ),
                                React.createElement('div', { className: "space-y-2" },
                                    tasks.map(task => 
                                        React.createElement('div', { 
                                            key: task.id,
                                            className: "flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50"
                                        },
                                            React.createElement('div', { className: "flex items-center gap-3" },
                                                React.createElement('input', {
                                                    type: "checkbox",
                                                    checked: task.status === 'completed',
                                                    onChange: () => {
                                                        setTasks(tasks.map(t => 
                                                            t.id === task.id 
                                                                ? { ...t, status: t.status === 'completed' ? 'pending' : 'completed' }
                                                                : t
                                                        ));
                                                    },
                                                    className: "w-5 h-5"
                                                }),
                                                React.createElement('span', {
                                                    className: task.status === 'completed' ? 'line-through text-gray-500' : ''
                                                }, task.title)
                                            ),
                                            React.createElement('span', {
                                                className: `px-2 py-1 text-xs rounded-full ${
                                                    task.priority === 'high' ? 'bg-red-100 text-red-700' :
                                                    task.priority === 'normal' ? 'bg-blue-100 text-blue-700' :
                                                    'bg-green-100 text-green-700'
                                                }`
                                            }, task.priority)
                                        )
                                    )
                                )
                            )
                        )
                    );
                };
                
                const root = ReactDOM.createRoot(document.getElementById('root'));
                root.render(React.createElement(TestApp));
            }
        }, 1000); // Aspetta 1 secondo per essere sicuri che tutto sia caricato
    </script>
</body>
</html>